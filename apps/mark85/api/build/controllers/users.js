(function(_0x3e8ab4,_0x88e981){const _0x121a6b=a2_0x4588,_0x5eb0e1=_0x3e8ab4();while(!![]){try{const _0x454980=parseInt(_0x121a6b(0x1c2))/0x1+-parseInt(_0x121a6b(0x1c1))/0x2*(parseInt(_0x121a6b(0x1c9))/0x3)+-parseInt(_0x121a6b(0x1d0))/0x4+parseInt(_0x121a6b(0x1c4))/0x5+parseInt(_0x121a6b(0x1d2))/0x6+-parseInt(_0x121a6b(0x1c3))/0x7*(parseInt(_0x121a6b(0x1ce))/0x8)+-parseInt(_0x121a6b(0x1c0))/0x9;if(_0x454980===_0x88e981)break;else _0x5eb0e1['push'](_0x5eb0e1['shift']());}catch(_0x35d745){_0x5eb0e1['push'](_0x5eb0e1['shift']());}}}(a2_0x2224,0xa63ab));import a2_0x1be9d2 from'../models/user';function a2_0x4588(_0x226c1c,_0x3c3fc0){const _0x2224e3=a2_0x2224();return a2_0x4588=function(_0x458812,_0xa2a4e2){_0x458812=_0x458812-0x1c0;let _0x394a25=_0x2224e3[_0x458812];return _0x394a25;},a2_0x4588(_0x226c1c,_0x3c3fc0);}function a2_0x2224(){const _0xcfa24=['json','body','save','83896exAcxP','compare','1278396cZBMwh','hash','2645952ucLJRc','status','name','end','password','6680088sOHSEa','6whDjjf','1336603HGTwfL','651AGarsy','4703675mKVEGz','sign','qax','findOne','Duplicated\x20email!','333WzHWCL','10d'];a2_0x2224=function(){return _0xcfa24;};return a2_0x2224();}import a2_0x4a43b7 from'bcrypt';import a2_0x1dcda3 from'jsonwebtoken';export default{'auth':async(_0x308773,_0x34c1fc)=>{const _0x289a20=a2_0x4588,{email:_0x18e2ed,password:_0x7fdeb7}=_0x308773[_0x289a20(0x1cc)],_0x1ec321=await a2_0x1be9d2[_0x289a20(0x1c7)]({'email':_0x18e2ed});if(!_0x1ec321)return _0x34c1fc[_0x289a20(0x1d3)](0x191)['end']();if(!await a2_0x4a43b7[_0x289a20(0x1cf)](_0x7fdeb7,_0x1ec321[_0x289a20(0x1d6)]))return _0x34c1fc[_0x289a20(0x1d3)](0x191)[_0x289a20(0x1d5)]();const {id:_0x9f5e5}=_0x1ec321;return _0x34c1fc[_0x289a20(0x1cb)]({'user':_0x1ec321,'token':a2_0x1dcda3[_0x289a20(0x1c5)]({'id':_0x9f5e5,'user':_0x1ec321},_0x289a20(0x1c6),{'expiresIn':_0x289a20(0x1ca)}),'expires_in':_0x289a20(0x1ca)});},'create':async(_0x44045d,_0x4aab99)=>{const _0x1448f0=a2_0x4588,{name:_0x347b03,email:_0x2db25d,password:_0x3e8e1c}=_0x44045d['body'],_0x1686d4=await a2_0x1be9d2[_0x1448f0(0x1c7)]({'email':_0x2db25d});if(_0x1686d4)return _0x4aab99[_0x1448f0(0x1d3)](0x199)[_0x1448f0(0x1cb)]({'message':_0x1448f0(0x1c8)});const _0x1cadf0=await a2_0x4a43b7[_0x1448f0(0x1d1)](_0x3e8e1c,0x8),_0x40203f={'name':_0x347b03,'email':_0x2db25d,'password':_0x1cadf0};try{let _0x15cb53=new a2_0x1be9d2(_0x40203f);const _0x186193=await _0x15cb53[_0x1448f0(0x1cd)]();return _0x4aab99[_0x1448f0(0x1d3)](0xc8)['json'](_0x186193);}catch(_0x1ce367){if(_0x1ce367[_0x1448f0(0x1d4)]==='ValidationError')return _0x4aab99[_0x1448f0(0x1d3)](0x190)[_0x1448f0(0x1cb)](_0x1ce367);return _0x4aab99[_0x1448f0(0x1d3)](0x1f4)[_0x1448f0(0x1cb)](_0x1ce367);}}};